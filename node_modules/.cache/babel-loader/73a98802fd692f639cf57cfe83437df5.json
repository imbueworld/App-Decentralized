{"ast":null,"code":"var _jsxFileName = \"/Users/carrabre/Documents/GitHub/App-Decentralized/src/components/pages/PurchaseEvent.js\";\nimport React, { Component } from \"react\";\nimport \"../../App.css\";\nimport { Container, Row, Col, Image } from \"react-bootstrap\";\nimport back from \"../../images/dashboard.jpg\";\nimport ethereum from '../../images/ethereum.jpg';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst {\n  ethers\n} = require(\"ethers\");\n\nconst eventList = require(\"../../contract/EventList.json\");\n\nexport default class PurchaseEvent extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = async () => {\n      const walletAddress = await localStorage.getItem(\"walletaddress\");\n      console.log(\"wallet Address:\", walletAddress);\n      this.setState({\n        walletAddress: walletAddress,\n        walletBalance: localStorage.getItem('walletBalance')\n      });\n      var str = this.state.walletAddress;\n      var res = str.substring(0, 7);\n      var last2 = str.slice(-4);\n      console.log(\"res:\", res + '...' + last2);\n      this.setState({\n        address: res + '...' + last2\n      });\n    };\n\n    this.purchaseEvent = async () => {\n      var currency;\n      await axios.get(\"https://min-api.cryptocompare.com/data/price?fsym=USD&tsyms=ETH\").then(res => {\n        currency = res.data['ETH'];\n      });\n      var event = JSON.parse(localStorage.getItem('events'))[0];\n      console.log('event', Number(event[5].hex));\n      console.log('event', event);\n\n      if (event[4] == false) {\n        this.props.history.push(\"EventBooked\");\n      } else {\n        try {\n          const ethereum = window.ethereum;\n\n          if (ethereum) {\n            const provider = new ethers.providers.Web3Provider(window.ethereum, \"any\");\n            const signer = provider.getSigner();\n            console.log(\"Address:\", await signer.getAddress());\n            var sender = await signer.getAddress();\n            var receiver = event[6];\n            await provider.send(\"eth_requestAccounts\", []);\n            const params = [{\n              from: sender,\n              to: receiver,\n              value: ethers.utils.parseUnits((currency * Number(event[5].hex)).toString(), 'ether').toHexString()\n            }];\n            const transactionHash = await provider.send('eth_sendTransaction', params);\n            console.log('transactionHash is ', transactionHash);\n            const newProvider = new ethers.providers.Web3Provider(window.ethereum, \"any\"); // Prompt user for account connections\n\n            await newProvider.send(\"eth_requestAccounts\", []);\n            const newSigner = newProvider.getSigner();\n            let balance = await newProvider.getBalance(newSigner.getAddress());\n            localStorage.setItem('walletBalance', ethers.utils.formatEther(balance)); // const contract = new ethers.Contract(eventList.networks['5777'].address, eventList.abi, signer);\n\n            this.props.history.push(\"EventBooked\");\n          }\n        } catch (err) {\n          console.log(\"error is :\", err);\n        }\n      }\n    };\n\n    this.state = {\n      walletAddress: \"\",\n      address: '',\n      walletBalance: '',\n      currency: 0.0\n    };\n    this.purchaseEvent = this.purchaseEvent.bind(this);\n  }\n\n  render() {\n    const address = this.state.address;\n    const walletBalance = this.state.walletBalance;\n    var background = {\n      backgroundSize: \"cover\",\n      width: \"50vw\",\n      height: \"20%\",\n      marginLeft: \"25%\",\n      marginRight: 20,\n      marginTop: 20\n    };\n    var textStyle = {\n      position: \"absolute\",\n      top: \"50%\",\n      left: \"50%\"\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      style: {\n        backgroundColor: \"#FFFFFF\",\n        width: \"100vw\",\n        height: \"100vh\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: \"100%\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: \"center\",\n              marginTop: 36,\n              fontSize: 40,\n              fontFamily: \"MyWebFont\"\n            },\n            children: \"I M B U E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wallet-status\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: 15,\n              height: 15,\n              backgroundColor: \"#9CFFA6\",\n              borderRadius: \"50%\",\n              marginTop: 8\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              height: 31,\n              backgroundColor: \"#edeef2\",\n              fontSize: 11,\n              lineHeight: \"31px\",\n              paddingLeft: 10,\n              paddingRight: 10,\n              fontWeight: 500,\n              marginLeft: 10\n            },\n            children: [walletBalance, \" ETH\", /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                marginLeft: 10,\n                padding: \"5px 8px\",\n                borderRadius: 5,\n                backgroundColor: \"#f7f8fa\"\n              },\n              children: [address, /*#__PURE__*/_jsxDEV(\"img\", {\n                style: {\n                  width: 12,\n                  marginLeft: 10\n                },\n                src: ethereum\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 27\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 30,\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: back,\n          style: {\n            width: 950\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          onClick: this.purchaseEvent,\n          className: \"join-button\",\n          style: {\n            left: 720\n          },\n          children: \"Purchase Event\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"inline-flex\",\n          textAlign: \"center\",\n          fontFamily: 'MyWebFont',\n          fontSize: 15\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            paddingLeft: 180,\n            paddingTop: 15\n          },\n          children: \"workout live\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            paddingLeft: 80,\n            paddingTop: 5\n          },\n          children: [\"workout with me and get all the tips\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 49\n          }, this), \"of the tips of the trade.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            paddingLeft: 90,\n            paddingTop: 10\n          },\n          children: [\"8 am - 9 am \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 25\n          }, this), \"July 21 2021\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/carrabre/Documents/GitHub/App-Decentralized/src/components/pages/PurchaseEvent.js"],"names":["React","Component","Container","Row","Col","Image","back","ethereum","axios","ethers","require","eventList","PurchaseEvent","constructor","props","componentDidMount","walletAddress","localStorage","getItem","console","log","setState","walletBalance","str","state","res","substring","last2","slice","address","purchaseEvent","currency","get","then","data","event","JSON","parse","Number","hex","history","push","window","provider","providers","Web3Provider","signer","getSigner","getAddress","sender","receiver","send","params","from","to","value","utils","parseUnits","toString","toHexString","transactionHash","newProvider","newSigner","balance","getBalance","setItem","formatEther","err","bind","render","background","backgroundSize","width","height","marginLeft","marginRight","marginTop","textStyle","position","top","left","backgroundColor","textAlign","fontSize","fontFamily","borderRadius","lineHeight","paddingLeft","paddingRight","fontWeight","padding","display","paddingTop"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"../../App.css\";\nimport { Container, Row, Col, Image } from \"react-bootstrap\";\nimport back from \"../../images/dashboard.jpg\";\nimport ethereum from '../../images/ethereum.jpg';\nimport axios from 'axios';\n\nconst { ethers } = require(\"ethers\");\nconst eventList = require(\"../../contract/EventList.json\");\n\nexport default class PurchaseEvent extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      walletAddress: \"\",\n      address: '',\n      walletBalance: '',\n      currency: 0.0\n    };\n    this.purchaseEvent = this.purchaseEvent.bind(this);\n  }\n  componentDidMount = async () => {\n    const walletAddress = await localStorage.getItem(\"walletaddress\");\n    console.log(\"wallet Address:\", walletAddress);\n    this.setState({ walletAddress: walletAddress, walletBalance: localStorage.getItem('walletBalance') });\n    var str = this.state.walletAddress;\n    var res = str.substring(0, 7);\n    var last2 = str.slice(-4);\n    console.log(\"res:\", res + '...' + last2);\n    this.setState({ address: res + '...' + last2 })\n\n    \n  }\n\n  purchaseEvent = async () => {\n    var currency;\n    await axios.get(\"https://min-api.cryptocompare.com/data/price?fsym=USD&tsyms=ETH\")\n      .then(res => {\n        currency = res.data['ETH'];\n      })\n    var event = JSON.parse(localStorage.getItem('events'))[0];\n    console.log('event', Number(event[5].hex));\n    console.log('event', event);\n    if (event[4] == false) {\n      this.props.history.push(\"EventBooked\");\n    } else {\n      try {\n        const ethereum = window.ethereum;\n\n        if (ethereum) {\n          const provider = new ethers.providers.Web3Provider(\n            window.ethereum,\n            \"any\"\n          );\n          const signer = provider.getSigner();\n\n          console.log(\"Address:\", await signer.getAddress());\n\n          var sender = await signer.getAddress();\n          var receiver = event[6];\n\n          await provider.send(\"eth_requestAccounts\", []);\n          const params = [{\n              from: sender,\n              to: receiver,\n              value: ethers.utils.parseUnits((currency * Number(event[5].hex)).toString(), 'ether').toHexString()\n          }];\n\n\n          const transactionHash = await provider.send('eth_sendTransaction', params);\n     \n          console.log('transactionHash is ', transactionHash);\n\n          const newProvider = new ethers.providers.Web3Provider(\n            window.ethereum,\n            \"any\"\n          );\n          // Prompt user for account connections\n          await newProvider.send(\"eth_requestAccounts\", []);\n          const newSigner = newProvider.getSigner();\n\n          let balance = await newProvider.getBalance(newSigner.getAddress());\n\n          localStorage.setItem('walletBalance', ethers.utils.formatEther(balance));\n\n\n          // const contract = new ethers.Contract(eventList.networks['5777'].address, eventList.abi, signer);\n\n          this.props.history.push(\"EventBooked\");\n        }\n      } catch (err) {\n        console.log(\"error is :\", err);\n      }\n    }\n  }\n\n  render() {\n    const address = this.state.address;\n    const walletBalance = this.state.walletBalance;\n\n    var background = {\n      backgroundSize: \"cover\",\n      width: \"50vw\",\n      height: \"20%\",\n      marginLeft: \"25%\",\n      marginRight: 20,\n      marginTop: 20,\n    };\n    var textStyle = {\n      position: \"absolute\",\n      top: \"50%\",\n      left: \"50%\",\n    };\n    return (\n      <div className=\"container\"\n        style={{ backgroundColor: \"#FFFFFF\", width: \"100vw\", height: \"100vh\" }}\n      >\n        <div style={{ width: \"100%\" }}>\n          <div>\n            <div\n              style={{\n                textAlign: \"center\",\n                marginTop: 36,\n                fontSize:40,\n                fontFamily: \"MyWebFont\",\n              }}\n            >\n              I M B U E\n            </div>\n          </div>\n          <div className=\"wallet-status\">\n            <div style={{ width: 15, height: 15, backgroundColor: \"#9CFFA6\", borderRadius: \"50%\", marginTop: 8 }}>\n            </div>\n            <div style={{ height: 31, \n                          backgroundColor: \"#edeef2\", \n                          fontSize: 11,\n                          lineHeight: \"31px\",\n                          paddingLeft: 10,\n                          paddingRight: 10,\n                          fontWeight: 500,\n                          marginLeft: 10 }}>\n                          { walletBalance } ETH\n                          <span style={{ marginLeft: 10, padding: \"5px 8px\", borderRadius: 5, backgroundColor: \"#f7f8fa\"}}>\n                            { address }\n                            <img style={{ width: 12, marginLeft: 10 }} src={ethereum} />\n                          </span>\n            </div>\n          </div>\n        </div>\n        \n        <div style={{ marginTop: 30,\n                      textAlign: \"center\" }}>\n          <img src={back} style={{ width: 950 }}/>\n          <a onClick={this.purchaseEvent} className=\"join-button\" style={{ left: 720 }}>\n            Purchase Event\n          </a>\n        </div>\n        <div style={{\n          display: \"inline-flex\",\n          textAlign: \"center\",\n          fontFamily: 'MyWebFont',\n          fontSize: 15\n        }}>\n          <div style={{\n            paddingLeft: 180,\n            paddingTop: 15\n          }}>\n            workout live\n          </div>\n          <div style={{\n            paddingLeft: 80,\n            paddingTop: 5\n          }}>\n            workout with me and get all the tips<br/>of the tips of the trade.\n          </div>\n          <div style={{\n            paddingLeft: 90,\n            paddingTop: 10\n          }}>\n            8 am - 9 am <br/>July 21 2021\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}